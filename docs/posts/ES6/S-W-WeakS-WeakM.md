# S-W-WeakS-WeakM

其实在平常的来发中这一块用的其实很少，但是感觉在现在的工作中，实际的开发过程中需要自己做到：

1. 不能只是了解一个知识点，然后再去用它，做项目每使用一项技术（框架，组件库，插件，新的语言体系），事先都得需要看项目中的可行性，存在哪些潜在风险，以及潜在风险是否有能力去修复，以及社区是否强大

2. 如果可以保持技术的领先，最好让技术带领项目走，而不是项目带着技术走，不能因为技术儿影响项目的主要功能点，每一个项目总是会有某些不好完成的功能和效果，但是需求出来的时候至少心中要有实现的方案，所以要更多的学习，有些技术点不是不好实现，而是在遇到问题之前没有了解相关的技术，所以觉得某些功能实现不了

这是前段时间做完公文流转V1.0.0之后的一个比较明确的感想，扯远了，还是说今天的要弄懂的东西吧

## 1. Set(集合)

1. Set本身是一种新的数据结构，类似于数组，但是成员是唯一且无序的，没有重复值，有一点值得注意：在Set内部判断两个是否相等的时候，认为`NaN`是等于`NaN`的

2. 实例属性：

* constructor:构造函数
* size:元素数量

3. 实例方法

* 操作方法

  * add(value)
  * delete(value)
  * has(value)
  * clear()

* 遍历方法

  * keys()
  * values()
  * entries()
  * forEach()

这个方法和相关的知识，平成用的还是挺多的，也没什么好说的，如果又不知道的，可以翻看之前的文章，写这一片文章主要也不是在了解这个方法，而是去了解和熟悉下面的几种方法

## 2. WeakSet

1. 首先弄清楚一点，这四种数据结构都不是数组，Set的成员可以为任意类型的值，但是WeakSet的成员只能是对象

2. WeakSet对象中储存的对象值都是被弱引用的，也就是说，垃圾回收机制不考虑WeakSet对该对象的应用，如果没有其他的变量或者属性引用这个对象值，则这个对象会被垃圾回收掉（不会考虑对象还存在于WeakSet中），所以，WeakSet对象里面有多少个成员元素，取决于垃圾回收机制有没有运行，运行前后成员个数可能是不一致的

3. 属性：

* constructor：构造函数任何一个具有Iterable接口的对象，都可以作为参数

4. 方法

* add(value)
* has(value)
* delete(value)
* clear() <font color=red>已经被废弃</font>

5.  <font color=red>值得注意一点的是：ES6 规定 WeakSet 不可遍历，也没有办法拿到它包含的所有元素</font>

## 3. Map(字典)

1. Set(集合) 与 Map(字典) 的区别：

* 共同点：集合、字典可以储存不重复的值

* 不同点：集合是以`[value, value]`的形式储存元素，字典以 `[key, value]`的形式储存

2. 属性

* constructor：构造函数 <font color=red>任何具有Iterator接口、且每个成员都是一个双元素的数组的数据结构都可以当作map构造函数的参数</font>

* size：返回字典中所包含的元素个数

3. 操作方法

* set(key, value)
* get(key)
* has(key)
* claer()

4. 遍历方法

* keys()
* values()
* entries()
* forEach

## 4. WeakMap

1. WeakMap对象是一组键值对的集合，其中的键是弱引用对象，而值可以任意

2. 值得注意的是，WeakMap弱引用的只是键名，而不是键值，键值依然是正常引用

3. WeakMap中，每个键对自己所引用对象的引用都是弱引用，在没有其他引用和该键引用同一个对象，这个对象将会被垃圾回收机制回收（相对应的key就成为了无效的了），所以WeakMap的key是不可枚举的

4. 属性

* constructor：构造函数

5. 方法：

* has(key)
* set(key, value)
* get(key)
* delete(key)

## 总结

* Set

  * 成员唯一、无序且不重复
  * [value, value]，键值与键名是一致的（或者说只有键值，没有键名）
  * 可以遍历，方法有：add、delete、has

* WeakSet

  * 成员都是对象
  * 成员都是弱引用，可以被垃圾回收机制回收，可以用来保存DOM节点，不容易造成内存泄漏
  * 不能遍历，方法有add、delete、has

* Map

  * 本质上是键值对的集合，类似集合
  * 可以遍历，方法很多可以跟各种数据格式转换

* WeakMap

  * 只接受对象作为键名（null除外），不接受其他类型的值作为键名
  * 键名是弱引用，键值可以是任意的，键名所指向的对象可以被垃圾回收，此时键名是无效的
  * 不能遍历，方法有get、set、has、delete

<back-to-top />

<gitask />